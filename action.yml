name: 'Assign Labels From Conventional Commits'
description: 'Assign labels to pull-request parsing conventional commits standard'
inputs:
  pull-request-number:
    description: 'The pull request'' number where labels will be assigned'
    required: true
  github-token:
    description: 'The Github token.'
    required: true
  clear-all-labels-to-start:
    description: 'Should be removed all labels assigned to the pull request before begin.'
    required: false
    default: false
  remove-labels-not-found:
    description: 'Should be removed the labels previously assigned that don''t present a reference in the current conventional commits.'
    required: false
    default: true
  conventional-commits-file:
    description: 'YAML file that contains a list with conventional commits and the labels matching that must be assigned'
    required: false
    default: 'conventional-commits.yml'
  not-apply-changes:
    description: 'Should will executing the action without applying any change to the repository'
    required: false
    default: false
outputs:
  labels-assigned:
    description: 'List of the labels assigned'
    value: ${{ steps.assign-labels.outputs.labels-assigned }}
  labels-removed:
    description: 'List of the labels removed'
    value: ${{ steps.remove-labels.outputs.labels-removed }}
  action-status:
    description: 'Execution status of the action'
    value: ${{ steps.start.outputs.action-status }}
  action-message:
    description: 'Message associated to the current status of the action'
    value: ${{ steps.start.outputs.action-message }}
runs:
  using: composite
  steps:
    - name: Preparing
      id: start
      shell: bash
      run: |
        echo "::set-output name=action-status::STARTING"
        echo "::set-output name=action-message::"

        echo "GITHUB_TOKEN=${{ inputs.github-token }}" >> $GITHUB_ENV

        echo "::set-output name=action-status::STARTED"
        echo "::set-output name=action-message::"

    - name: End
      id: end
      shell: bash
      run: |
        echo "::set-output name=action-status::ENDING"
        echo "::set-output name=action-message::"

        echo "::set-output name=labels-assigned::"
        echo "::set-output name=labels-removed::"

        echo "::set-output name=action-status::ENDED"
        echo "::set-output name=action-message::"
